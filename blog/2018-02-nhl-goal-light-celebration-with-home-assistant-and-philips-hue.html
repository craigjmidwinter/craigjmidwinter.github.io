<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-3777ddffe584dc82.js"/><script src="/_next/static/chunks/4bd1b696-d31891ed15a5103e.js" async=""></script><script src="/_next/static/chunks/517-3adf9217b4ee675a.js" async=""></script><script src="/_next/static/chunks/main-app-3b8a8eba0304deb0.js" async=""></script><script src="/_next/static/chunks/ee560e2c-c5c28398d0153d35.js" async=""></script><script src="/_next/static/chunks/322-53eb1d32bf710b44.js" async=""></script><script src="/_next/static/chunks/173-52b2b489d82616e2.js" async=""></script><script src="/_next/static/chunks/590-97f4dc9b90039a27.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-9af1e0a685a480c8.js" async=""></script><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/><title>Craig Midwinter - Personal Website</title><meta name="description" content="Welcome to my personal website. Check out my resume, GitHub, LinkedIn, podcast, and blog posts."/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&amp;display=swap" rel="stylesheet"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body><video autoPlay="" loop="" muted="" class="sc-cMqPwU jJIuNk"><source src="/outrun-waves_1.webm" type="video/webm"/></video><nav class="sc-FEMpB cMMXFN"><ul class="sc-gjcoXW kIaxle"><li class="sc-dVBluf iGNEod"><a href="/blog">BLOG HOME</a></li><li class="sc-dVBluf iGNEod"><a href="/">ABOUT CRAIG</a></li></ul></nav><div class="sc-jUkaYT hNzkKj"><div class="sc-jHswkR goaCnt"><p>2018-02-11</p><h1>NHL goal light celebration with Home Assistant and Philips Hue</h1></div><div class="sc-deSjom dYLfrY"><p><strong>Note:</strong> This blog is an archive. Some content may be out of date, and images may be broken or missing. If you find an issue or have a question, please email <strong>craig.j.midwinter@gmail.com</strong>.</p></div><p><strong>2025 Update:</strong> *The Goalfeed integration is now a free addon instead of a component with a paid subscription.
Everything else in this guide should still be relevant though.
See <a href="https://github.com/goalfeed/hassio-goalfeed-repository">Goalfeed Hassio Addon</a></p>
<p>Ok, so here’s one of the automations that I think is pretty fun-- my neighbours might disagree though. This is how I use Home Assistant to automatically trigger a goal celebration whenever the Winnipeg Jets score!</p>
<p><del>So, this relies on the <a href="https://home-assistant.io/components/goalfeed/">Goalfeed component</a> that is in the 0.63
release of Home Assistant, which requires an account with <a href="https://goalfeed.ca/">goalfeed.ca</a> (full disclosure, I wrote
and operate this service and there&#x27;s a $1.99/month subscription to cover server cost and external services etc). Once
you’ve got the account and your credentials are in your configuration,</del> Home Assistant will fire events every time an
NHL or MLB team scores. These events can be used to trigger whatever automation you want.</p>
<p>Now, the way this component works is that it fires an event called ‘goal’ for every goal or run scored, the event has some event data that is included which basically just identifies which team scored. Ultimately, the automation is going to look like this:</p>
<pre><div class="sc-jZTQcj hRjXcY"><button class="sc-dkBYrC bHcmTX"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg> Copy</button><div style="color:#f92aad;text-shadow:0 0 2px #100c0f, 0 0 5px #dc078e33, 0 0 10px #fff3;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background-color:transparent !important;background-image:linear-gradient(to bottom, #2a2139 75%, #34294f)"><code class="language-yaml" style="white-space:pre;color:#f92aad;text-shadow:0 0 2px #100c0f, 0 0 5px #dc078e33, 0 0 10px #fff3;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>    </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">alias</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f87c32">&#x27;Jets Goal&#x27;</span><span>
</span><span>      </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">hide_entity</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575;font-weight:bold">true</span><span>
</span><span>      </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">trigger</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">platform</span><span class="token token" style="color:#ccc">:</span><span> event
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">event_type</span><span class="token token" style="color:#ccc">:</span><span> goal
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">event_data</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">team_name</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f87c32">&quot;Winnipeg Jets&quot;</span><span>
</span><span>      </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">action</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>      </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">delay</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f87c32">&quot;00:00:{{ states.input_number.goalfeed.state | int }}&quot;</span><span>
</span><span>      </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> homeassistant.turn_on
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> input_boolean.goaling
</span><span>      </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> media_player.play_media
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">data</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> media_player.everywhere
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">media_content_id</span><span class="token token" style="color:#ccc">:</span><span> https</span><span class="token token" style="color:#ccc">:</span><span>//hassbian.local</span><span class="token token" style="color:#ccc">:</span><span>8123/local/audio/goalhorn1718.mp3
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">media_content_type</span><span class="token token" style="color:#ccc">:</span><span> audio/mp3
</span><span>      </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> script.turn_on
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> script.goal_start</span></code></div></div></pre>
<p>Since we don’t want to trigger this automation every single time any team scores, we’ve got to specify the event data that we want to match in the automation trigger. You’ll notice there’s a lot going on in the action of this automation.</p>
<p>First, in the action, I have this delay instruction with this template:</p>
<pre><div class="sc-jZTQcj hRjXcY"><button class="sc-dkBYrC bHcmTX"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg> Copy</button><div style="color:#f92aad;text-shadow:0 0 2px #100c0f, 0 0 5px #dc078e33, 0 0 10px #fff3;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background-color:transparent !important;background-image:linear-gradient(to bottom, #2a2139 75%, #34294f)"><code class="language-yaml" style="white-space:pre;color:#f92aad;text-shadow:0 0 2px #100c0f, 0 0 5px #dc078e33, 0 0 10px #fff3;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>      </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">delay</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f87c32">&quot;00:00:{{ states.input_number.goalfeed.state | int }}&quot;</span></code></div></div></pre>
<p>I’ve added an input_number entity in my config like this:</p>
<pre><div class="sc-jZTQcj hRjXcY"><button class="sc-dkBYrC bHcmTX"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg> Copy</button><div style="color:#f92aad;text-shadow:0 0 2px #100c0f, 0 0 5px #dc078e33, 0 0 10px #fff3;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background-color:transparent !important;background-image:linear-gradient(to bottom, #2a2139 75%, #34294f)"><code class="language-yaml" style="white-space:pre;color:#f92aad;text-shadow:0 0 2px #100c0f, 0 0 5px #dc078e33, 0 0 10px #fff3;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>    </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">input_number</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>      </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">goalfeed</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">name</span><span class="token token" style="color:#ccc">:</span><span> Goalfeed Delay
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">initial</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#e2777a">30</span><span>
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">min</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#e2777a">0</span><span>
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">max</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#e2777a">180</span><span>
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">step</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#e2777a">1</span></code></div></div></pre>
<p>The reason for this is that the goalfeed events usually come in really quickly. I watch most games online, and depending on the source and my connection, the time between when the event comes in and when I see the goal sometimes requires a bit of tweaking, so having a nice little slider in the front end to configure this is key.</p>
<p>The next action item is setting an input_boolean (which I also added in my main config). I just set this to true to represent the fact that the goal light script is running. I’ll show you how I use this in the second automation.</p>
<p>The third item is the call to my media_player entity, which is a group of google homes/chrome cast audios that plays an mp3 of the Jets goal horn throughout the house.</p>
<p>The last item is turns on a script, which basically makes the light show work. I’ll get to that in a minute, but let’s go back to that input boolean for a second.</p>
<p>The input boolean that we turn on in the first automation we use as a trigger for a second automation that ends the goal celebration. That automation looks like this:</p>
<pre><div class="sc-jZTQcj hRjXcY"><button class="sc-dkBYrC bHcmTX"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg> Copy</button><div style="color:#f92aad;text-shadow:0 0 2px #100c0f, 0 0 5px #dc078e33, 0 0 10px #fff3;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background-color:transparent !important;background-image:linear-gradient(to bottom, #2a2139 75%, #34294f)"><code class="language-yaml" style="white-space:pre;color:#f92aad;text-shadow:0 0 2px #100c0f, 0 0 5px #dc078e33, 0 0 10px #fff3;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>    </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">alias</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f87c32">&#x27;Turn off goal&#x27;</span><span>
</span><span>      </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">trigger</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">platform</span><span class="token token" style="color:#ccc">:</span><span> state
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> input_boolean.goaling
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">to</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f87c32">&#x27;on&#x27;</span><span>
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">for</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">seconds</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#e2777a">30</span><span>
</span><span>      </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">action</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>      </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> media_player.stop_media
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">data</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> media_player.everywhere
</span><span>      </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> script.turn_on
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> script.goal_stop
</span><span>      </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> homeassistant.turn_off
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> input_boolean.goaling</span></code></div></div></pre>
<p>This is pretty straightforward-- when the input_boolean has been ‘on’ for 30 seconds, this automation runs, it runs a stop script and sets the input_boolean back to ‘off’.</p>
<p>Ok, now let’s take a look at the scripts for the light sequence.</p>
<pre><div class="sc-jZTQcj hRjXcY"><button class="sc-dkBYrC bHcmTX"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg> Copy</button><div style="color:#f92aad;text-shadow:0 0 2px #100c0f, 0 0 5px #dc078e33, 0 0 10px #fff3;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background-color:transparent !important;background-image:linear-gradient(to bottom, #2a2139 75%, #34294f)"><code class="language-yaml" style="white-space:pre;color:#f92aad;text-shadow:0 0 2px #100c0f, 0 0 5px #dc078e33, 0 0 10px #fff3;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>    </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">goal_start</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>      </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">sequence</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>      </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> scene.turn_on
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> scene.all_dark
</span><span>      </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> script.turn_on
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> script.goal_repeat
</span>    
<span>    </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">goal_loop</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>      </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">sequence</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">condition</span><span class="token token" style="color:#ccc">:</span><span> state
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> input_boolean.goaling
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">state</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f87c32">&#x27;on&#x27;</span><span>
</span><span>        </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">alias</span><span class="token token" style="color:#ccc">:</span><span> swon
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> homeassistant.turn_on
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">data</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> light.goallight
</span><span>            </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">rgb_color</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#e2777a">255</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#e2777a">0</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#e2777a">0</span><span class="token token" style="color:#ccc">]</span><span>
</span><span>            </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">brightness</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#e2777a">255</span><span>
</span><span>            </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">transition</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#e2777a">0.25</span><span>
</span><span>        </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">delay</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">seconds</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#e2777a">0.25</span><span>
</span><span>        </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">condition</span><span class="token token" style="color:#ccc">:</span><span> state
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> input_boolean.goaling
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">state</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f87c32">&#x27;on&#x27;</span><span>
</span><span>        </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">alias</span><span class="token token" style="color:#ccc">:</span><span> swoff
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> homeassistant.turn_off
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">data</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> light.goallight
</span><span>            </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">transition</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#e2777a">0.25</span><span>
</span><span>        </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">delay</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">seconds</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#e2777a">0.25</span><span>
</span><span>        </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">alias</span><span class="token token" style="color:#ccc">:</span><span> loop
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> script.turn_on
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">data</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> script.goal_repeat
</span>    
<span>    </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">goal_repeat</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>      </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">sequence</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">condition</span><span class="token token" style="color:#ccc">:</span><span> state
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> input_boolean.goaling
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">state</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f87c32">&#x27;on&#x27;</span><span>
</span><span>        </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">delay</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">seconds</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#e2777a">1.5</span><span>
</span><span>        </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> script.turn_on
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> script.goal_loop
</span>    
<span>    </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">goal_stop</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>      </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">sequence</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>      </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> homeassistant.turn_off
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> script.goal_loop
</span><span>      </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> homeassistant.turn_off
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> script.goal_repeat
</span><span>      </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> homeassistant.turn_on
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> group.main_floor
</span><span>      </span><span class="token token" style="color:#ccc">-</span><span> </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">service</span><span class="token token" style="color:#ccc">:</span><span> light.turn_on
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">entity_id</span><span class="token token" style="color:#ccc">:</span><span> light.goallight
</span><span>        </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">data</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">brightness</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#e2777a">255</span><span>
</span><span>          </span><span class="token token key" style="color:#f4eee4;text-shadow:0 0 2px #393a33, 0 0 8px #f39f0575, 0 0 2px #f39f0575">rgb_color</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#e2777a">255</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#e2777a">172</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#e2777a">68</span><span class="token token" style="color:#ccc">]</span></code></div></div></pre>
<p>So, there are four scripts here in my setup. The first is the start script. This handles turning off all of my non-colour changing lights and then starts the goal loop.</p>
<p>The goal loop consists of two scripts and the reason why have two is that we need two scripts in order to make the looping mechanism work-- the first script has our light sequence and then it triggers the second script, which basically just triggers the first script again.</p>
<p>There are two things that might be worth noting about the primary goal script, but I’ve gone into more detail on both of these things in other posts, so if you are curious, feel free to follow the links to those posts. The first is using a single light entity to control a group of hue bulbs-- I outline this a bit <a href="https://midwinter.cc/post/quick-tip-controlling-colour-of-groups-of-philips-hue-lights-in-home-assistant_SJEXvIslG/">in this quick tip</a>. The second is the use of the transition and delay instructions-- the need for a delay in this use of transition is covered a bit more in my <a href="https://midwinter.cc/post/using-home-assistant-and-philips-hue-to-create-a-full-colour-sunrise-alarm-clock_H1waliSbG/">post on building a sunrise alarm clock</a>.</p>
<p>Feel free to comment with any questions that you might have!</p></div><script src="/_next/static/chunks/webpack-3777ddffe584dc82.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[15244,[],\"\"]\n3:I[43866,[],\"\"]\n5:I[86213,[],\"OutletBoundary\"]\n7:I[86213,[],\"MetadataBoundary\"]\n9:I[86213,[],\"ViewportBoundary\"]\nb:I[34835,[],\"\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"cJ_3B2T7oi6g9cI1NlS7C\",\"p\":\"\",\"c\":[\"\",\"blog\",\"2018-02-nhl-goal-light-celebration-with-home-assistant-and-philips-hue\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"2018-02-nhl-goal-light-celebration-with-home-assistant-and-philips-hue\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.googleapis.com\"}],[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.gstatic.com\",\"crossOrigin\":\"\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Press+Start+2P\u0026display=swap\",\"rel\":\"stylesheet\"}]]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"2018-02-nhl-goal-light-celebration-with-home-assistant-and-philips-hue\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",null,[\"$\",\"$L5\",null,{\"children\":\"$L6\"}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"lKaVFqwA3nJRm4j-fggf1\",{\"children\":[[\"$\",\"$L7\",null,{\"children\":\"$L8\"}],[\"$\",\"$L9\",null,{\"children\":\"$La\"}],null]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$b\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"c:I[86880,[\"844\",\"static/chunks/ee560e2c-c5c28398d0153d35.js\",\"322\",\"static/chunks/322-53eb1d32bf710b44.js\",\"173\",\"static/chunks/173-52b2b489d82616e2.js\",\"590\",\"static/chunks/590-97f4dc9b90039a27.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-9af1e0a685a480c8.js\"],\"default\"]\nd:T1c11,"])</script><script>self.__next_f.push([1,"\n**2025 Update:** *The Goalfeed integration is now a free addon instead of a component with a paid subscription.\nEverything else in this guide should still be relevant though.\nSee [Goalfeed Hassio Addon](https://github.com/goalfeed/hassio-goalfeed-repository)\n\nOk, so here’s one of the automations that I think is pretty fun-- my neighbours might disagree though. This is how I use Home Assistant to automatically trigger a goal celebration whenever the Winnipeg Jets score!\n\n~~So, this relies on the [Goalfeed component](https://home-assistant.io/components/goalfeed/) that is in the 0.63\nrelease of Home Assistant, which requires an account with [goalfeed.ca](https://goalfeed.ca/) (full disclosure, I wrote\nand operate this service and there's a $1.99/month subscription to cover server cost and external services etc). Once\nyou’ve got the account and your credentials are in your configuration,~~ Home Assistant will fire events every time an\nNHL or MLB team scores. These events can be used to trigger whatever automation you want.\n\nNow, the way this component works is that it fires an event called ‘goal’ for every goal or run scored, the event has some event data that is included which basically just identifies which team scored. Ultimately, the automation is going to look like this:\n\n```yaml\n    - alias: 'Jets Goal'\n      hide_entity: true\n      trigger:\n        platform: event\n        event_type: goal\n        event_data:\n          team_name: \"Winnipeg Jets\"\n      action:\n      - delay: \"00:00:{{ states.input_number.goalfeed.state | int }}\"\n      - service: homeassistant.turn_on\n        entity_id: input_boolean.goaling\n      - service: media_player.play_media\n        data:\n          entity_id: media_player.everywhere\n          media_content_id: https://hassbian.local:8123/local/audio/goalhorn1718.mp3\n          media_content_type: audio/mp3\n      - service: script.turn_on\n        entity_id: script.goal_start\n```\n\nSince we don’t want to trigger this automation every single time any team scores, we’ve got to specify the event data that we want to match in the automation trigger. You’ll notice there’s a lot going on in the action of this automation.\n\nFirst, in the action, I have this delay instruction with this template:\n\n```yaml\n      - delay: \"00:00:{{ states.input_number.goalfeed.state | int }}\"\n```    \n\nI’ve added an input_number entity in my config like this:\n\n```yaml\n    input_number:\n      goalfeed:\n        name: Goalfeed Delay\n        initial: 30\n        min: 0\n        max: 180\n        step: 1\n```\n\nThe reason for this is that the goalfeed events usually come in really quickly. I watch most games online, and depending on the source and my connection, the time between when the event comes in and when I see the goal sometimes requires a bit of tweaking, so having a nice little slider in the front end to configure this is key.\n\nThe next action item is setting an input_boolean (which I also added in my main config). I just set this to true to represent the fact that the goal light script is running. I’ll show you how I use this in the second automation.\n\nThe third item is the call to my media_player entity, which is a group of google homes/chrome cast audios that plays an mp3 of the Jets goal horn throughout the house.\n\nThe last item is turns on a script, which basically makes the light show work. I’ll get to that in a minute, but let’s go back to that input boolean for a second.\n\nThe input boolean that we turn on in the first automation we use as a trigger for a second automation that ends the goal celebration. That automation looks like this:\n\n```yaml\n    - alias: 'Turn off goal'\n      trigger:\n        platform: state\n        entity_id: input_boolean.goaling\n        to: 'on'\n        for:\n          seconds: 30\n      action:\n      - service: media_player.stop_media\n        data:\n          entity_id: media_player.everywhere\n      - service: script.turn_on\n        entity_id: script.goal_stop\n      - service: homeassistant.turn_off\n        entity_id: input_boolean.goaling\n```\n\nThis is pretty straightforward-- when the input_boolean has been ‘on’ for 30 seconds, this automation runs, it runs a stop script and sets the input_boolean back to ‘off’.\n\nOk, now let’s take a look at the scripts for the light sequence.\n\n```yaml\n    goal_start:\n      sequence:\n      - service: scene.turn_on\n        entity_id: scene.all_dark\n      - service: script.turn_on\n        entity_id: script.goal_repeat\n    \n    goal_loop:\n      sequence:\n        - condition: state\n          entity_id: input_boolean.goaling\n          state: 'on'\n        - alias: swon\n          service: homeassistant.turn_on\n          data:\n            entity_id: light.goallight\n            rgb_color: [255, 0, 0]\n            brightness: 255\n            transition: 0.25\n        - delay:\n            seconds: 0.25\n        - condition: state\n          entity_id: input_boolean.goaling\n          state: 'on'\n        - alias: swoff\n          service: homeassistant.turn_off\n          data:\n            entity_id: light.goallight\n            transition: 0.25\n        - delay:\n            seconds: 0.25\n        - alias: loop\n          service: script.turn_on\n          data:\n            entity_id: script.goal_repeat\n    \n    goal_repeat:\n      sequence:\n        - condition: state\n          entity_id: input_boolean.goaling\n          state: 'on'\n        - delay:\n            seconds: 1.5\n        - service: script.turn_on\n          entity_id: script.goal_loop\n    \n    goal_stop:\n      sequence:\n      - service: homeassistant.turn_off\n        entity_id: script.goal_loop\n      - service: homeassistant.turn_off\n        entity_id: script.goal_repeat\n      - service: homeassistant.turn_on\n        entity_id: group.main_floor\n      - service: light.turn_on\n        entity_id: light.goallight\n        data:\n          brightness: 255\n          rgb_color: [255, 172, 68]\n```\n\nSo, there are four scripts here in my setup. The first is the start script. This handles turning off all of my non-colour changing lights and then starts the goal loop.\n\nThe goal loop consists of two scripts and the reason why have two is that we need two scripts in order to make the looping mechanism work-- the first script has our light sequence and then it triggers the second script, which basically just triggers the first script again.\n\nThere are two things that might be worth noting about the primary goal script, but I’ve gone into more detail on both of these things in other posts, so if you are curious, feel free to follow the links to those posts. The first is using a single light entity to control a group of hue bulbs-- I outline this a bit [in this quick tip](https://midwinter.cc/post/quick-tip-controlling-colour-of-groups-of-philips-hue-lights-in-home-assistant_SJEXvIslG/). The second is the use of the transition and delay instructions-- the need for a delay in this use of transition is covered a bit more in my [post on building a sunrise alarm clock](https://midwinter.cc/post/using-home-assistant-and-philips-hue-to-create-a-full-colour-sunrise-alarm-clock_H1waliSbG/).\n\nFeel free to comment with any questions that you might have!\n"])</script><script>self.__next_f.push([1,"4:[\"$\",\"$Lc\",null,{\"post\":{\"slug\":\"2018-02-nhl-goal-light-celebration-with-home-assistant-and-philips-hue\",\"title\":\"NHL goal light celebration with Home Assistant and Philips Hue\",\"date_published\":\"$D2018-02-11T22:02:00.000Z\",\"date_updated\":\"$D2018-12-14T03:46:14.000Z\",\"tags\":\"Home Assistant, Home Automation, NHL, Goallight, Philips Hue, Goalfeed, YAML\",\"cover_image\":\"\",\"content\":\"$d\"}}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Craig Midwinter - Personal Website\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Welcome to my personal website. Check out my resume, GitHub, LinkedIn, podcast, and blog posts.\"}],[\"$\",\"link\",\"3\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]]\n"])</script><script>self.__next_f.push([1,"6:null\n"])</script></body></html>